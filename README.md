# Color Palette Generator

My goal with this project was an end-to-end machine learning project, and although I admit when I found out about [Colormind](http://colormind.io) I almost gave up on this, they're using deep GANs, I was gonna use K-Means, but I decided to go through with it anyway even though it's not deep learning so not cool by definition, my simple app lives on.

A deep Generative Adverserial Network is on my list of things to try next.

## Web App

[![Streamlit App](https://static.streamlit.io/badges/streamlit_badge_black_white.svg)](https://a-tabaza-color-palette-generator-app-erznb7.streamlit.app)

The app is deployed on Streamlit. You can try it [here](https://a-tabaza-color-palette-generator-app-erznb7.streamlit.app)
![GUI](GUI.png)
 I used [IntelÂ® Extension for Scikit-learn](https://intel.github.io/scikit-learn-intelex/) to optimize my app since it trains a model for each picture the user uploads, I'm satisfied with the results, the app is fast and responsive.

## Experimental Results

### K-Means Clustering (Ensemble of K-Means and MiniBatchKMeans)

![Chungking Express](chungking_express.png)
Still from *Chungking Express* (1994) by Wong Kar-Wai

<details>

<summary>Palette Sorted by Luminance</summary>

- *k* = 8
![Fallen Angels](fallen_angels.jpg)
Still from *Fallen Angels* (1995) by Wong Kar-Wai
- k = 12
![Drive](drive.jpg)
Still from *Drive (2011)* by Nicolas Winding Refn

</details>

<details>

<summary>Randomly Sampled Colors from Larger Number of Clusters</summary>

Stills from *Parasite (2019)* by Bong Joon-ho

- *k* = 36

![Parasite](parasite_36.png)

- *k* = 36, 8 random colors are selected for palette
![Parasite](randomly_sampled_parasite.png)

- *k* = 36, full palette
![Parasite](36_kmeans.png)

- *k* = 1, but image was segmented into 36 regions to generate palette
![Parastite](36_segmented.png)

</details>

<details>

<summary> Effect of Scale on Palette </summary>

K-Means Clustering (Ensemble of K-Means and MiniBatchKMeans)

Stills from *Parasite (2019)* by Bong Joon-ho

*k* = 8

- Scaling Factor = 0.5
![Parasrite](parasite_05.png)
- Scaling Factor = 0.6
![Parasite](parasite_06.png)
- Scaling Factor = 0.7
![Parasite](parasite_07.png)
- Scaling Factor = 0.8
![Parasite](parasite_08.png)
- Scaling Factor = 0.9
![Parasite](parasite_09.png)

</details>

## Conclusions

The range of colors is limited and sorted by dominance as opposed to prominence in image. Take this image for example, the palette should include the color of the pupils, but it doesn't even when I use 16 clusters.

For reference, the palette generated by Colormind is shown below, although it took a couple of random generates, it did detect the pupil colod, which is what I'd like my model to achieve.

![Dune](dune_still.jpeg)
Still from *Dune (2021)* by Denis Villeneuve
![Colormind Palette](colormind.png)